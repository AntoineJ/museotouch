#:kivy 1.0
#:import math math

#:set futuraBold 'widgets/fonts/FuturaLT-Bold.ttf'
#:set futura 'widgets/fonts/FuturaLT-Oblique.ttf'
#:set arial 'widgets/fonts/Arial.ttf'
#:set arialB 'widgets/fonts/Arial Bold.ttf'
#:set arialBI 'widgets/fonts/Arial Bold Italic.ttf'
#:set arialI 'widgets/fonts/Arial Italic.ttf'

#:set gHeight 1080
#:set gWidth 1920

<QuizzSelector>:
    do_scale: False
    do_rotation: False
    do_translation: False
    size: 180,180

    img_active_1: img_active_1
    img_active_2: img_active_2

    Image:
        source: 'widgets/quizzSelector/btn-player.png'
        size: 180,180

    Image:
        id: img_active_1
        source: 'widgets/quizzSelector/btn-player-active1.png'
        size: 180,180
        opacity:0

    Image:
        id: img_active_2
        source: 'widgets/quizzSelector/btn-player-active2.png'
        size: 180,180
        opacity: 0

    Button:
        id: but1
        size_hint: None, None
        background_down: 'widgets/quizzSelector/btn-player-1pl.png'
        background_normal: 'widgets/quizzSelector/btn-player-1pl.png'
        size: 70, 70
        center: 51,129
        on_press: root.on_press(root, 'but1')
        on_release: root.on_release(root, 'but1')

    Button:
        id: but2
        size_hint: None, None
        # pos_hint: None
        background_down: 'widgets/quizzSelector/btn-player-2pl.png'
        background_normal: 'widgets/quizzSelector/btn-player-2pl.png'
        size: 70, 70
        center: 110,70
        on_press: root.on_press(root, 'but2')
        on_release: root.on_release(root, 'but2')

<QuizzMere>
    canvas.before:
        Color:
            rgba: (1,1,1,1) if root.deuxJoueurs else (1,1,1,0)
        Line: 
            width: 2
            points: (root.J1x, root.J1y, root.J2x, root.J2y) if root.deuxJoueurs else (0,0,0,0)

<QuizzItem>:
    labelTitre: labelTitre
    # labelMauvaiseReponse: labelMauvaiseReponse
    labelReponse: labelReponse
    btnMauvaiseReponse: btnMauvaiseReponse
    btnBonneReponse: btnBonneReponse
    btnContinuez: btnContinuez
    photo: photo
    labelScore: labelScore
    imageScoreWin: imageScoreWin
    imageScoreLose: imageScoreLose
    btnClose: btnClose
    # ligne: ligne
    size_hint: (None, None)
    size: 230, 354
    pos: -100,-100
    scale: 1
    do_scale: False
    do_collide_after_children: True

    canvas.before:
         # add shadow background
        Color:
            rgba: 1,1,1,1
        BorderImage:
            source: 'widgets/shadow32.png'
            border: (26,26,26,26)
            size:(root.width+52, root.height+52)
            pos: (-26,-26)
        Rectangle:
            pos: 0,0
            size: self.size
        Color:
            rgba: 1,1,1,.5
        Line:
            points: (-2,self.height-1 ,  -65-2,self.height-1   ,   -65-2,self.height-114-1   ,   -2,self.height-114-1) if root.correction else (-2,self.height-1 ,  -65-2,self.height-1   ,   -65-2,self.height-60-1 -114   ,   -2,self.height-60-114-1)
            width: 1.5
            close: True
            cap: 'square'
        Rectangle:
            pos: 0,0
            size: self.size
        Color:
            rgb: 117/255.,113/255.,81/255.
        Line:
            width: 1 
            points: (10, self.height_bar,220, self.height_bar) #if not root.correction else (10,self.height - 30,220,self.height - 30)

    Image:
        id: imageScoreWin
        source: 'widgets/score-win.png'
        size: 62,62
        pos: -64, root.height-60
        opacity: 1
    
    Image:
        id: imageScoreLose
        source: 'widgets/score-lose.png'
        size: 62,62
        pos: -64, root.height-60
        opacity: 0





    Label:
        id: labelScore
        size_hint: (None, None)
        pos_hint: (None, None)
        color: 1,1,1, .9
        pos: -64, root.height-100
        text: str(root.score) + '/5'
        text_size: (60, 50)
        # shorten: True
        size: (60,50)
        font_size: 30
        halign: 'center'
        valign: 'middle'
        font_name: futuraBold
    
    Label:
        id: labelTimer
        size_hint: (None, None)
        pos_hint: (None, None)
        color: 1,1,1, .9
        pos: -64, root.height-110-50
        text: str(int(root.mere.timer)) if not root.correction else ''
        text_size: (60, 50)
        # shorten: True
        size: (60,50)
        font_size: 40
        halign: 'center'
        valign: 'middle'
        font_name: futuraBold

    Label:
        size_hint: None,None
        pos_hint: (None,None)
        color: 1,1,1,.5
        text: 'SCORE'
        font_size: 17
        text_size: (60,25) 
        size: (60,25)   
        font_name: futuraBold
        pos: -65, root.height-116

    Label:
        size_hint: None,None
        pos_hint: (None,None)
        color: (1,1,1,.5) if not root.correction else (1,1,1,0)
        text: 'TEMPS' if not root.mere.english else 'TIMER'
        font_size: 17
        text_size: (60,25) 
        size: (60,25)   
        font_name: futuraBold
        pos: -65, root.height-110-50-15

    Image:
        id: photo
        keep_ratio: False
        allow_stretch: True
        pos_hint: (None, None)
        size_hint: (None, None)
        pos: 0, 124
        size: 230,230
        source: ''

    Label:
        id: labelTitre
        size_hint: (None, None)
        pos_hint: (None, None)
        color: 117/255.,113/255.,81/255.,1
        pos: 10, 90
        text: ''
        text_size: (210, None)
        # shorten: True
        size: (210, self.texture_size[1])
        font_size: 12
        halign: 'left'
        valign: 'middle'
        font_name: futuraBold

    QuizzToggleButton:
        id: btnMauvaiseReponse
        # disabled: True
        group: str(root)
        size_hint: (None, None)
        background_color: 117/255.,113/255.,81/255.,1
        color: 1,1,1,1
        pos: (10, 10)
        text: ''
        text_size: (190, None)
        size: (210, self.texture_size[1]) if self.texture_size[1] > 32 else (210,32)
        font_size: 10
        halign: 'left'
        valign: 'middle'
        font_name: futuraBold
        on_release: root.do_reponse()

    QuizzToggleButton:
        id: btnBonneReponse
        group: str(root)
        size_hint: (None, None)
        background_color: 117/255.,113/255.,81/255.,1
        color: 1,1,1,1
        pos: (10,10) 
        text: ''
        text_size: (190, None)
        # size: (210, 54)
        size: (210, self.texture_size[1]) if self.texture_size[1] > 32 else (210,32)
        font_size: 10
        halign: 'left'
        valign: 'middle'
        font_name: futuraBold
        on_release: root.do_reponse()

    QuizzButton:
        canvas.before:
            Color: 
                rgba: (117/255.,113/255.,81/255., 1) if self.state == 'down' else (63/255.,61/255.,40/255., 1)
            Line:
                width: 8
                circle: 26, 26, 8
            Line:
                width: 8
                circle: 204, 26, 8
            Rectangle: 
                pos: 26,10
                size: 210-32, 32




        id: btnContinuez
        # background_normal: 'widgets/btn-restart.png'
        # background_down: 'widgets/btn-restart.png'
        background_color: 1,1,1,0
        font_color: 0,0,0,1
        size_hint: (None, None)
        pos: 10,100
        text: 'CONTINUER'
        text_size: 190,32
        size: 210,32
        font_size: 10
        halign: 'center'
        valign: 'middle'
        font_name: futuraBold
        opacity: 0

       
    # Label:
    #     id: labelMauvaiseReponse
    #     size_hint: (None, None)
    #     pos_hint: (None, None)
    #     color: 117/255.,113/255.,81/255.,1
    #     pos: 10, 45
    #     # text: root.item.description2 if root.correction and not root.bonneReponse else ''
    #     text: root.item.description2
    #     # text: ''
    #     text_size: (210, 80)
    #     # shorten: True
    #     size: (210, 80)
    #     font_size: 7
    #     halign: 'justify'
    #     valign: 'middle'
    #     font_name: arial

    Label:
        id: labelReponse
        size_hint: (None, None)
        pos_hint: (None, None)
        color: 117/255.,113/255.,81/255.,1
        pos: 10, 55
        text: ''
        text_size: (210, None)
        size: (210, self.texture_size[1])
        font_size: 12
        halign: 'justify'
        valign: 'bottom'
        font_name: arial



    QuizzButton:
        id: btnClose
        size_hint: (None, None)
        size: 100,100
        background_normal: 'widgets/btn-close.png'
        background_down: 'widgets/btn-close-active.png'
        pos: root.width - 50, root.height -50
        auto_bring_to_front: True
        opacity: 1

    # Label:
    #     id: labelTimer
    #     size_hint: (None, None)
    #     pos_hint: (None, None)
    #     center: 115,20
    #     size: 20,20
    #     text_size: 20,20
    #     text: str(int(root.mere.timer)) if not root.correction else ''
    #     font_size: 12
    #     halign: 'center'
    #     valign: 'bottom'
    #     font_name: arial

    # Label:
    #     id: labelReponse
    #     size_hint: (None, None)
    #     pos_hint: (None, None)
    #     color: 117/255.,113/255.,81/255.,1
    #     pos: 10, 45
    #     text: ''
    #     text_size: (210, None)
    #     size: (210, 80)
    #     font_size: 10
    #     halign: 'justify'
    #     valign: 'middle'
    #     font_name: arial
